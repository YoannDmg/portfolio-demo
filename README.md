# Crypto Portfolio Demo

Real-time cryptocurrency portfolio management with AI-powered price alerts.

## Tech Stack

- **Frontend**: React 19, TypeScript, Tailwind CSS 4, shadcn/ui
- **Backend**: Convex (real-time database + serverless functions)
- **Market Data**: Binance Public API
- **AI Analysis**: OpenRouter (Mistral 7B)

---

## Features

- **Portfolio Management**: Deposit/withdraw USDT, buy/sell crypto at market prices
- **Real-Time Prices**: Auto-refresh every 30 seconds from Binance
- **Price Alerts**: Cron job monitors 24h price changes, triggers when > 5%
- **AI Analysis**: Each alert includes market commentary generated by Mistral AI
- **Transaction History**: Complete audit trail of all operations

---

## Architecture

```
┌──────────────────────────────────────────────────────────┐
│  FRONTEND (React)                                        │
│  App.tsx → Hooks (usePrices, useTrading, useStats)       │
│          → Components (Cards, Tables, Notifications)     │
└────────────────────────┬─────────────────────────────────┘
                         │ useQuery / useMutation / useAction
                         ▼
┌──────────────────────────────────────────────────────────┐
│  CONVEX BACKEND                                          │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌───────────────┐   │
│  │ wallet  │ │ trading │ │ alerts  │ │ notifications │   │
│  └─────────┘ └─────────┘ └─────────┘ └───────────────┘   │
│  ┌─────────────────────────────────────────────────────┐ │
│  │  crons: check-price-alerts (every 5 min)            │ │
│  └─────────────────────────────────────────────────────┘ │
│                         │                                │
│  ┌─────────────────────────────────────────────────────┐ │
│  │  Database: wallet │ assets │ transactions │ notifs  │ │
│  └─────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────┘
           │                    │
           ▼                    ▼
     ┌──────────┐         ┌──────────┐
     │ Binance  │         │OpenRouter│
     │  (Prices)│         │   (AI)   │
     └──────────┘         └──────────┘
```

---

## Data Model

```typescript
// wallet - USDT balance
{ balance: number }

// assets - Portfolio holdings
{ symbol: string, quantity: number, avgBuyPrice: number }

// transactions - Audit log
{ type: "deposit"|"withdraw"|"buy"|"sell", symbol?, quantity, price?, total, timestamp }

// notifications - AI alerts
{ symbol, type: "price_up"|"price_down", priceChange, currentPrice, aiAnalysis, timestamp, read }
```

---

## Project Structure

```
├── convex/
│   ├── schema.ts          # Database schema
│   ├── wallet.ts          # Deposit/withdraw
│   ├── trading.ts         # Buy/sell with Binance prices
│   ├── alerts.ts          # Price monitoring + AI analysis
│   ├── crons.ts           # Scheduled price checks
│   └── notifications.ts   # Alert management
│
├── src/
│   ├── App.tsx            # Root component
│   ├── components/        # UI (Header, Cards, Tables, Notifications)
│   ├── hooks/             # usePrices, useTrading, usePortfolioStats
│   └── types/             # TypeScript definitions
```

---

## Getting Started

### Prerequisites

- Node.js 20+
- Convex account (free)
- OpenRouter API key (free)

### Installation

```bash
git clone https://github.com/YoannDmg/portfolio-demo.git
cd portfolio-demo
npm install
```

### Configuration

Add `OPENROUTER_API_KEY` in [Convex Dashboard](https://dashboard.convex.dev) → Environment Variables

### Run

```bash
# Terminal 1
npx convex dev

# Terminal 2
npm run dev
```

Open http://localhost:5173

---

## Alert System

**Trigger**: 24h price change > 5%

**Flow**:
1. Cron job runs every 5 minutes
2. Fetches 24h ticker from Binance for each portfolio asset
3. If threshold exceeded → generates AI analysis via OpenRouter
4. Creates notification in database (real-time UI update)

**AI Prompt**:
```
You are a crypto market analyst.
Provide a concise market insight (3–4 sentences) about the price movement.
Include: likely catalysts, volatility comparison, short-term sentiment.
Do NOT provide financial advice.
```

---

## Scripts

```bash
npm run dev        # Start frontend
npx convex dev     # Start backend
npm run build      # Production build
npm run typecheck  # TypeScript validation
```

---

## License

MIT